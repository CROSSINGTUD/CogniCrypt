--- RCPTT testcase ---
Format-Version: 1.0
Element-Name: DigitalSigs
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _IumZoDEcEei8vfE9G7Yzvw
Runtime-Version: 2.2.0.201705230341
Save-Time: 4/2/18 10:25 PM
Testcase-Type: ecl

------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa
Content-Type: text/plain
Entry-Name: .description

This test tries to test the functionality of all the widgets in the Clafer page . It should always execute successfully.
------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa--
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

get-button "Integrate a Cryptographic Task into CogniCrypt" | click
with [get-window -from "WizardAction.run()" | get-window -class WizardDialog] {
    get-editbox -after [get-label "Name of the Task"] | set-text DigitalSigs
    get-button "Next >" | click
    get-button Modify -index 13 | click
    with [get-window -class ClaferFeatureDialog] {
        get-button "Add property" | click
        with [get-editbox -after [get-label Name]] {
            set-text scheme
            key-type "TRAVERSE_TAB_NEXT"
        }
        get-combo -after [get-label "is of type"] | set-text SignatureScheme
    }
}
set-dialog-result MessageBox 64
with [get-window -from "WizardAction.run()" | get-window -class WizardDialog] {
    get-window -class ClaferFeatureDialog | get-button OK | click
    get-button Modify -index 14 | click
    with [get-window -class ClaferFeatureDialog] {
        get-combo -after [get-label "Inherits from"] | select Algorithm
        with [get-button "Add property"] {
            click
            click
            click
        }
        get-combo -after [get-label "is of type"] | select Security
        get-combo -after [get-label "is of type" -after [get-label Name -after [get-label "is of type"]]] 
            | select Performance
        get-combo -after [get-label "is of type" -after [get-label Name -after [get-label "is of type" 
            -after [get-label Name -after [get-label "is of type"]]]]] | select integer
        get-editbox -after [get-label Name -after [get-label "is of type" -after [get-label Name 
            -after [get-label "is of type"]]]] | set-text keysize
        get-button OK | click
    }
    get-button "Add Feature" | click
    with [get-window -class ClaferFeatureDialog] {
        get-combo -after [get-label Implements] | select SignatureScheme
        get-editbox -after [get-label "Type in the name"] | set-text ECDSA
        get-button "Add constraint" | click
        with [get-window -class ClaferConstraintDialog] {
            with [get-tree] {
                get-item -path "abstract SignatureScheme: Algorithm/security -> Security" | click
                select "abstract SignatureScheme: Algorithm/security -> Security" | double-click
                get-item -path "abstract SignatureScheme: Algorithm/security -> Security" | click
            }
            get-group "" | get-button EQUALS | click
            with [get-tree] {
                select "Strong: Security = 4" | double-click
                get-item -path "Strong: Security = 4" | click
            }
            get-button OK | click
        }
        get-button "Add constraint" | click
        with [get-window -class ClaferConstraintDialog] {
            with [get-tree] {
                get-item -path "abstract SignatureScheme: Algorithm/performance -> Performance" | click
                select "abstract SignatureScheme: Algorithm/performance -> Performance" | double-click
                get-item -path "abstract SignatureScheme: Algorithm/performance -> Performance" | click
            }
            get-group "" | get-button EQUALS | click
            with [get-tree] {
                select "Medium: Security = 3" | double-click
                get-item -path "Medium: Security = 3" | click
            }
            get-button OK | click
        }
        get-button "Add constraint" | click
        with [get-window -class ClaferConstraintDialog] {
            with [get-tree] {
                get-item -path "abstract SignatureScheme: Algorithm/keysize -> integer" | click
                select "abstract SignatureScheme: Algorithm/keysize -> integer" | double-click
                get-item -path "abstract SignatureScheme: Algorithm/keysize -> integer" | click
            }
            get-group "" | get-button EQUALS | click
            get-editbox | set-text "keysize = 256"
            get-button OK | click
        }
        get-button OK | click
    }
    get-button "Add Feature" | click
    with [get-window -class ClaferFeatureDialog] {
        get-editbox -after [get-label "Type in the name"] | set-text RSA
        get-combo -after [get-label Implements] | select SignatureScheme
        get-button "Add constraint" | click
        with [get-window -class ClaferConstraintDialog] {
            with [get-tree] {
                get-item -path "abstract SignatureScheme: Algorithm/security -> Security" | click
                select "abstract SignatureScheme: Algorithm/security -> Security" | double-click
                get-item -path "abstract SignatureScheme: Algorithm/security -> Security" | click
            }
            get-group "" | get-button EQUALS | click
            with [get-tree] {
                select "Medium: Security = 3" | double-click
                get-item -path "Medium: Security = 3" | click
            }
            get-button OK | click
        }
        get-button "Add constraint" | click
        with [get-window -class ClaferConstraintDialog] {
            with [get-tree] {
                get-item -path "abstract SignatureScheme: Algorithm/performance -> Performance" | click
                select "abstract SignatureScheme: Algorithm/performance -> Performance" | double-click
                get-item -path "abstract SignatureScheme: Algorithm/performance -> Performance" | click
            }
            get-group "" | get-button EQUALS | click
            with [get-tree] {
                get-item -path "Fast: Performance = 3" | click
                select "Fast: Performance = 3" | double-click
                get-item -path "Fast: Performance = 3" | click
            }
            get-button OK | click
        }
        get-button "Add constraint" | click
        with [get-window -class ClaferConstraintDialog] {
            with [get-tree] {
                get-item -path "abstract SignatureScheme: Algorithm/keysize -> integer" | click
                select "abstract SignatureScheme: Algorithm/keysize -> integer" | double-click
                get-item -path "abstract SignatureScheme: Algorithm/keysize -> integer" | click
            }
            get-group "" | get-button EQUALS | click
            get-editbox | set-text "keysize = 4096"
            get-button OK | click
        }
        get-button OK | click
    }
    get-button "Next >" | click
    get-button "Add Question" | click
    with [get-window -class QuestionDialog] {
        get-editbox -after [get-label Question] | set-text "Do you need both signing and verification?"
        get-combo -after [get-label "Answer type"] | select "Radio button"
        with [get-button "Add Answer"] {
            click
            click
        }
        with [get-group "" | get-editbox] {
            set-text "Only verification"
            set-text "Only signing"
        }
        with [get-group "" -after [get-label "Describe the question"] -index 1] {
            get-editbox | set-text "Both, signing and verification"
            get-button "Default Answer" | click
        }
        get-button OK | click
    }
    get-button "Add Question" | click
    with [get-window -class QuestionDialog] {
        get-editbox -after [get-label Question] | set-text "Do you prefer a particular Digital Signature Scheme?"
        get-combo -after [get-label "Answer type"] | select "Radio button"
        with [get-button "Add Answer"] {
            click
            click
            click
        }
        get-group "" | get-editbox | set-text "Yes, I would like to choose from a list."
        get-group "" -after [get-label "Describe the question"] -index 1 | get-editbox 
            | set-text "No, but I do need fast verification."
        with [get-group "" -after [get-label "Describe the question"] -index 2] {
            get-editbox | set-text "No, I would like state-of-the-art security."
            get-button "Default Answer" | click
        }
        get-button OK | click
    }
    get-button "Add Question" | click
    with [get-window -class QuestionDialog] {
        get-editbox -after [get-label Question] | set-text "What Digital Signature Scheme would you like to use?"
        get-combo -after [get-label "Answer type"] | select "Drop down"
        with [get-button "Add Answer"] {
            click
            click
        }
        get-group "" | get-editbox | set-text ECDSA
        get-group "" -after [get-label "Describe the question"] -index 1 | get-editbox | set-text RSA
        get-group "" | get-button "Default Answer" | click
        get-button OK | click
    }
    get-button "Click toLink Variabilityconstruct and  Link code" | click
    with [get-window -class AddDependenciesDialog] {
        get-tab-folder | get-tab-item "Link to variables to use in code" | click
        with [get-editbox -after [get-label "Variable Name:"]] {
            click-text 15
            set-text signingAndVerification
        }
        get-editbox -after [get-label "Set Value"] -index 1 | set-text signing
        get-editbox -after [get-label "Set Value"] -index 3 | set-text both
        get-button OK | click
    }
    get-button "Click toLink Variabilityconstruct and  Link code" -index 1 | click
    with [get-window -class AddDependenciesDialog] {
        get-button Add -after [get-label "Set Value"] -index 1 | click
        get-combo -after [get-label "Set Value"] | select scheme
        get-combo -after [get-label "Set Value"] -index 1 | select performance
        get-combo -after [get-label "Set Value"] -index 2 | select ">="
        get-editbox -after [get-label "Set Value"] -index 2 | set-text Fast
        get-button Add -after [get-label "Set Value"] -index 2 | click
        get-combo -after [get-label "Set Value"] -index 3 | select scheme
        get-combo -after [get-label "Set Value"] -index 4 | select security
        get-combo -after [get-label "Set Value"] -index 5 | select ">="
        get-editbox -after [get-label "Set Value"] -index 4 | set-text Strong
        get-button OK | click
    }
    get-button "Click toLink Variabilityconstruct and  Link code" -index 2 | click
    with [get-window -class AddDependenciesDialog] {
        get-button Add | click
        get-combo -after [get-label "Set Value"] | select scheme
        get-combo -after [get-label "Set Value"] -index 2 | select "="
        get-editbox -after [get-label "Set Value"] -index 1 | set-text ECDSA
        get-button Add -after [get-label "Set Value"] -index 1 | click
        get-combo -after [get-label "Set Value"] -index 3 | select scheme
        get-combo -after [get-label "Set Value"] -index 5 | select "="
        get-editbox -after [get-label "Set Value"] -index 3 | set-text RSA
        get-button OK | click
    }
    get-button "Next >" | click
    get-button "Click toLink Answer toother questions" -index 1 | click
    with [get-window -class LinkAnswerDialog] {
        get-group "" -after [get-label "Do you prefer a particular Digital Signature Scheme?"] -index 1 | get-combo 
            | select Default
        get-group "" -after [get-label "Do you prefer a particular Digital Signature Scheme?"] -index 2 | get-combo 
            | select "End Questionnaire"
        get-group "" -after [get-label "Do you prefer a particular Digital Signature Scheme?"] -index 3 | get-combo 
            | select "End Questionnaire"
        get-button OK | click
    }
    
    
}
get-window -from "WizardAction.run()" | get-window -class WizardDialog | get-button "Next >" | click
set-dialog-result File "/home/sics/integration/DigitalSignatures_templateusage.java"
with [get-window -from "WizardAction.run()" | get-window -class WizardDialog] {
    get-button "Get the code" | click
    with [get-editbox] {
        set-text-offset 24 3
        key-type Enter -times 2
        key-type Up
        key-type Enter
    }
}
set-dialog-result MessageBox 32
set-dialog-result File "/home/sics/integration/DigitalSignatures_signatures.java"
with [get-window -from "WizardAction.run()" | get-window -class WizardDialog] {
    get-button "Get the code" | click
    with [get-editbox] {
        set-text-offset 27 6
        type-text "Signatures.java"
        set-text-offset 24 3
        key-type Enter -times 2
        set-text-offset 0 5
    }
}
with [get-window -from "WizardAction.run()" | get-window -class WizardDialog] {
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-button "Add Attribute" | click
        get-group "" | get-combo -index 1 | set-text keysize
        get-button OK | click
    }
    get-editbox | set-text-offset 29 5
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select "Value of"
        get-button "Add Attribute" | click
        get-group "" | get-combo -index 1 | select "task.algorithm.keysize"
        get-button OK | click
    }
    get-editbox | set-text-offset 75 5
    with [get-tree] {
        get-item -path "abstract SignatureScheme: Algorithm" | click
        select "abstract SignatureScheme: Algorithm" | double-click
        get-item -path "abstract SignatureScheme: Algorithm" | click
    }
    get-editbox | set-text-offset 0 6
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-button "Add Attribute" | click
        get-group "" | get-combo -index 1 | set-text keyPairGenerator
        get-button OK | click
    }
    with [get-editbox] {
        set-text-offset 38 6
        key-type Enter -times 2
        set-text-offset 0 7
    }
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select Choose
        get-button OK | click
    }
    with [get-editbox] {
        set-text-offset 12 7
        key-type Enter -times 2
        set-text-offset 0 8
    }
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select When
        get-button "Add Attribute" | click
        get-group "" | get-combo -index 1 | select "task.element.scheme"
        get-button OK | click
    }
    with [get-editbox] {
        set-text-offset 60 8
        key-type Enter
    }
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select Otherwise
        get-button OK | click
    }
    get-editbox | set-text-offset 38 8
    with [get-tree] {
        get-item -path "DigitalSigs: Task" | click
        select "DigitalSigs: Task" | double-click
        get-item -path "DigitalSigs: Task" | click
    }
    with [get-editbox] {
        set-text-offset 58 8
        type-text "=''"
        key-type Left
    }
    with [get-tree] {
        get-item -path "RSA: SignatureScheme" | click
        select "RSA: SignatureScheme" | double-click
        get-item -path "RSA: SignatureScheme" | click
    }
    with [get-editbox] {
        set-text-offset 66 8
        type-text RSA
        set-text-offset 15 9
        type-text EC
        set-text-offset 15 11
        key-type Enter
    }
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-button "Add Attribute" | click
        get-group "" | get-combo -index 1 | set-text signatureAlgorithm
        get-button OK | click
    }
    with [get-editbox] {
        set-text-offset 40 12
        key-type Enter -times 2
        set-text-offset 0 13
    }
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select Choose
        get-button OK | click
    }
    with [get-editbox] {
        set-text-offset 12 13
        key-type Enter -times 2
        set-text-offset 0 14
    }
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select When
        get-button "Add Attribute" | click
        get-group "" | get-combo -index 1 | select "task.element.scheme"
        get-button OK | click
    }
    get-editbox | set-text-offset 38 14
    with [get-tree] {
        get-item -path "DigitalSigs: Task" | click
        select "DigitalSigs: Task" | double-click
        get-item -path "DigitalSigs: Task" | click
    }
    with [get-editbox] {
        set-text-offset 58 14
        type-text "=''"
        key-type Left
    }
    with [get-tree] {
        get-item -path "RSA: SignatureScheme" | click
        select "RSA: SignatureScheme" | double-click
        get-item -path "RSA: SignatureScheme" | click
    }
    with [get-editbox] {
        set-text-offset 66 14
        type-text SHA256withRSA
        key-type End
        key-type Enter
    }
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select Otherwise
        get-button OK | click
    }
    with [get-editbox] {
        set-text-offset 15 15
        type-text SHA256withECDSA
        set-text-selection -offset 49 -startLine 23 -endLine 23 -endOffset 54
    }
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select "Value of"
        get-button "Add Attribute" | click
        get-group "" | get-combo -index 1 | set-text "$keyPairGenerator"
        get-button OK | click
    }
    get-editbox | set-text-selection -offset 51 -startLine 24 -endLine 24 -endOffset 66
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select "Value of"
        get-button "Add Attribute" | click
        get-group "" | get-combo -index 1 | set-text "$signatureAlgorithm"
        get-button OK | click
    }
    get-editbox | set-text-selection -offset 17 -startLine 29 -endLine 29 -endOffset 20
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select "Value of"
        get-button "Add Attribute" | click
        get-group "" | get-combo -index 1 | set-text "$keysize"
        get-button OK | click
    }
    with [get-editbox] {
        set-text-offset 0 41
        key-type Tab
    }
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select If
        get-button "Add Attribute" | click
        get-group "" | get-combo -index 1 | select "task.code.signingAndVerification"
        get-button OK | click
    }
    with [get-editbox] {
        set-text-selection -offset 51 -startLine 41 -endLine 41 -endOffset 60
        key-type "M1+x"
        set-text-offset 0 49
        key-type Tab
        key-type "M1+v"
        set-text-offset 49 41
        type-text "=''"
        key-type Left
    }
    with [get-tree] {
        get-item -path "signingAndVerification = both" | click
        select "signingAndVerification = both" | double-click
        get-item -path "signingAndVerification = both" | click
    }
    get-editbox | set-text-selection -offset 15 -startLine 41 -endLine 41 -endOffset 92
    with [get-tree] {
        get-item -path "signingAndVerification = both" | click
        select "signingAndVerification = both" | double-click
        get-item -path "signingAndVerification = both" | click
    }
    with [get-editbox] {
        set-text-offset 0 69
        key-type Tab -times 2
    }
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select If
        get-button "Add Attribute" | click
        get-button OK | click
    }
    with [get-editbox] {
        set-text-selection -offset 18 -startLine 69 -endLine 69 -endOffset 27
        key-type "M1+x"
        set-text-offset 0 76
        key-type Tab -times 2
        key-type "M1+v"
        set-text-offset 16 69
    }
    with [get-tree] {
        get-item -path "signingAndVerification = both" | click
        get-item -path "signingAndVerification = both" | click
        get-item -path "signingAndVerification = both" | click
        select "signingAndVerification = both" | double-click
        get-item -path "signingAndVerification = both" | click
    }
}
set-dialog-result MessageBox 32
get-window -from "WizardAction.run()" | get-window -class WizardDialog | get-button Finish | click
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--
