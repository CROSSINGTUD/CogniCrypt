--- RCPTT testcase ---
Format-Version: 1.0
Element-Name: XslPageTest
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _cxsA8CycEeiM2Nq4fFAbNw
Runtime-Version: 2.1.0.201606221726
Save-Time: 3/21/18 1:11 AM
Testcase-Type: ecl

------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa
Content-Type: text/plain
Entry-Name: .description

This test mainly tries to test the functionality of all the widgets in the Xsl page . It should always execute successfully.
------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa--
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

get-button "Integrate a Cryptographic Task into CogniCrypt" | click
with [get-window -class WizardDialog] {
    get-editbox -after [get-label "Name of the Task"] | set-text "Xsl Page Test"
    with [get-editbox -after [get-label "Description of the Task :"]] {
        set-text "This test mainly tests the widgets functionality of Xsl page"
        key-type Enter
        set-text "This test mainly tests the widgets functionality of Xsl page\n"
        key-type Enter
        set-text "This test mainly tests the widgets functionality of Xsl page"
    }
    get-button "Next >" | click
    get-button "Add Feature" | click
    with [get-window -class ClaferFeatureDialog] {
        get-editbox -after [get-label "Type in the name"] | set-text Feature2
        get-combo -after [get-label "Inherits from"] | set-text Feature1
        get-button "Add property" | click
        with [get-editbox -after [get-label Name]] {
            set-text Prop1ofFeature1
            set-text Prop1ofFeature2
        }
        get-combo -after [get-label "is of type"] | set-text Feature1
        get-button "Add property" | click
        with [get-editbox -after [get-label Name -after [get-label "is of type"]]] {
            set-text Prop2ofFeature2
            key-type "TRAVERSE_TAB_NEXT"
        }
        get-combo -after [get-label "is of type" -after [get-label Name -after [get-label "is of type"]]] | select int
    }
}
set-dialog-result MessageBox 64
with [get-window -class WizardDialog] {
    get-window -class ClaferFeatureDialog | get-button OK | click
    get-button "Add Feature" | click
    with [get-window -class ClaferFeatureDialog] {
        with [get-editbox -after [get-label "Type in the name"]] {
            set-text Feature3
            key-type "TRAVERSE_TAB_NEXT"
        }
        with [get-combo -after [get-label "Inherits from"]] {
            select Feature2
            key-type "TRAVERSE_TAB_NEXT"
        }
        with [get-button "Add property"] {
            click
            click
        }
        with [get-editbox -after [get-label Name]] {
            set-text Prop1ofFeature3
            key-type "TRAVERSE_TAB_NEXT"
        }
        get-combo -after [get-label "is of type"] | select Feature1
        with [get-editbox -after [get-label Name -after [get-label "is of type"]]] {
            set-text Prop1ofFeature3
            set-text Prop2ofFeature3
        }
        with [get-combo -after [get-label "is of type" -after [get-label Name -after [get-label "is of type"]]]] {
            set-text Feature
            select Feature2
        }
        get-button OK | click
    }
    get-button "Add Feature" | click
    with [get-window -class ClaferFeatureDialog] {
        get-editbox -after [get-label "Type in the name"] | set-text ConcreteFeature
        get-combo -after [get-label "Inherits from"] | select Feature3
        get-button "Add property" | click
        with [get-editbox -after [get-label Name]] {
            set-text Prop1ofFeature
            key-type Left -times 7
            set-text Prop1ofConcreteFeature
            click-text 23
            key-type "M1+c"
        }
        get-combo -after [get-label "is of type"] | select int
        get-button "Add constraint" | click
        with [get-window -class ClaferConstraintDialog] {
            with [get-tree] {
                get-item "abstract Feature3: Feature2/Prop2ofFeature3 -> Feature2" | click
                select "abstract Feature3: Feature2/Prop2ofFeature3 -> Feature2" | double-click
                get-item "abstract Feature3: Feature2/Prop2ofFeature3 -> Feature2" | click
            }
            get-group "" | get-button EQUALS | click
            with [get-editbox] {
                key-type "M1+v"
                set-text "Feature3.Prop2ofFeature3 =value "
            }
            get-group "" | get-button OR | click
            with [get-editbox] {
                set-text "Feature3.Prop2ofFeature3 =value OR 9090"
                set-text "Feature3.Prop2ofFeature3 =8080 OR 9090"
            }
            get-button OK | click
        }
        get-button Remove | click
        get-button OK | click
    }
    get-button "Next >" | click
    get-button "Add Question" | click
    with [get-window -class QuestionDialog] {
        with [get-editbox -after [get-label Question]] {
            set-text Q0
            key-type "TRAVERSE_TAB_NEXT"
        }
        with [get-combo -after [get-label "Answer type"]] {
            select "Drop down"
            key-type "TRAVERSE_TAB_NEXT"
        }
        get-editbox -after [get-label "Describe the question"] | set-text "Q0 help content"
        get-button "Add Answer" | click
        get-group "" | get-editbox | set-text ans1
        get-button "Add Answer" | click
        get-group "" -after [get-label "Describe the question"] -index 1 | get-editbox | set-text ans2
        get-button OK | click
    }
    get-button "Add Question" | click
    with [get-window -class QuestionDialog] {
        get-editbox -after [get-label Question] | set-text Q1
        get-combo -after [get-label "Answer type"] | select "Text box"
        get-editbox -after [get-label "Describe the question"] | set-text "Q1 help content"
        get-button OK | click
    }
    get-button "Add Question" | click
    with [get-window -class QuestionDialog] {
        get-editbox -after [get-label Question] | set-text Q2
        get-combo -after [get-label "Answer type"] | select "Radio button"
        get-button "Add Answer" | click
        get-group "" | get-editbox | set-text ans1
        get-button "Add Answer" | click
        with [get-group "" -after [get-label "Describe the question"] -index 1] {
            with [get-editbox] {
                set-text ns2
                key-type Left -times 3
                set-text ans2
            }
            get-button "Default Answer" | click
        }
        get-button OK | click
    }
    get-button "Click toLink Variabilityconstruct and  Link code" | click
    with [get-window -class AddDependenciesDialog] {
        get-tab-folder | get-tab-item "Link to variables to use in code" | click
        get-editbox -after [get-label "Set Value"] -index 1 | set-text ans1
        get-editbox -after [get-label "Set Value"] -index 3 | set-text ans2
        get-button OK | click
    }
    get-button "Click toLink Variabilityconstruct and  Link code" -index 1 | click
    with [get-window -class AddDependenciesDialog] {
        get-tab-folder | get-tab-item "Link to variables to use in code" | click
        get-button OK | click
    }
    get-button "Click toLink Variabilityconstruct and  Link code" -index 2 | click
    with [get-window -class AddDependenciesDialog] {
        get-tab-folder | get-tab-item "Link to variables to use in code" | click
        get-editbox -after [get-label "Set Value"] -index 1 | set-text ans1of2
        get-editbox -after [get-label "Set Value"] -index 3 | set-text ans20f2
        get-button OK | click
    }
    get-button "Next >" | click
    get-button "Link Answer" | click
    with [get-window -class LinkAnswerDialog] {
        get-group "" -after [get-label Q0] -index 1 | get-combo | select Q1
        get-group "" -after [get-label Q0] -index 2 | get-combo | select Q2
        get-button OK | click
    }
    get-button "Link Answer" -index 1 | click
    get-window -class LinkAnswerDialog | get-button OK | click
    get-button "Link Answer" -index 2 | click
    with [get-window -class LinkAnswerDialog] {
        get-group "" -after [get-label Q2] -index 1 | get-combo | select "End Questionnaire"
        get-group "" -after [get-label Q2] -index 2 | get-combo | select "End Questionnaire"
        get-button OK | click
    }
    get-button "Next >" | click
}


with [get-window -class WizardDialog | get-editbox] {
    set-text-offset 0 0
    key-type "M1+v"
}
get-window -class WizardDialog | get-editbox -after [get-label "Add data for the code generation"] | click-text "1:46"
with [get-window -class WizardDialog] {
    get-editbox | set-text-offset 0 76
    get-button "Add Xsl Tag" | click
    get-window -class XSLTagDialog | get-button OK | click
    get-editbox | set-text-offset 0 4
    get-button "Add Xsl Tag" | click
    get-window -class XSLTagDialog | get-button OK | click
    get-editbox | set-text-offset 14 4
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select "Value of"
        get-button "Add Attribute" | click
        get-button OK | click
    }
    get-editbox | set-text-selection -offset 36 -startLine 4 -endLine 4 -endOffset 45
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-combo | select Choose
        get-button OK | click
    }
    get-tree | get-item "abstract Feature3: Feature2" | click
    get-editbox | set-text-offset 0 7
    with [get-tree] {
        get-item "abstract Feature2: Feature1" | click
        select "abstract Feature2: Feature1" | double-click
        get-item "abstract Feature2: Feature1" | click
    }
    get-editbox | set-text-offset 8 7
    with [get-tree] {
        get-item "abstract Feature1" | click
        select "abstract Feature1" | double-click
        get-item "abstract Feature1" | click
        get-item "abstract ConcreteFeature: Feature3" | click
        select "abstract ConcreteFeature: Feature3" | double-click
        get-item "abstract ConcreteFeature: Feature3" | click
    }
    get-button Finish | click
    get-editbox | set-text-offset 61 5
}
set-dialog-result MessageBox 32
set-dialog-result File
get-window -class WizardDialog | get-button "Get the code" | click
with [get-window -class WizardDialog] {
    get-button "Add Xsl Tag" | click
    with [get-window -class XSLTagDialog] {
        get-button "Add Attribute" | click
        get-group "" | get-combo -index 1 | set-text someAttr
        get-button OK | click
    }
    close
}
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--
